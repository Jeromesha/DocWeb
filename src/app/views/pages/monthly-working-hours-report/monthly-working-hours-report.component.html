<div class="d-flex justify-content-between align-items-center flex-wrap grid-margin">
    <div>

        <h4 class="mb-3 mb-md-0">&nbsp;{{'Monthly Working Hours Report ' | translate}}</h4>

    </div>
</div>
<div *ngIf="loading" class="loadesr"></div>
<div class="row text-left">
    <div class="col-md-12">
        <div class="card">
            <div class="card-content">
                <div class="card-body login-img">
                    <div class="px-3">
                        <form [formGroup]="form" class="form form-horizontal" novalidate>
                            <div class="form-body pt-2">
                                <div class="row">

                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="mandatory ">{{'Month' | translate}}</label>
                                            <mat-select placeholder="Select Month" formControlName="month"
                                                class="form-control pt-2"
                                                [disableOptionCentering]="true">
                                                <!-- <mat-select-filter [array]="months"
                                                    (filteredReturn)="months =$event">
                                                </mat-select-filter> -->
                                                <mat-option *ngFor="let item of months" [value]="item.key">
                                                    {{item.value}}
                                                </mat-option>
                                                <!-- <mat-option *ngFor="let month of months" [value]="month">{{ month }}</mat-option> -->
                                            </mat-select>
                                            <div class="valid-error"
                                                *ngIf="form.controls.month.errors && (form.controls.month.dirty || form.controls.month.touched)"
                                                text-wrap>
                                                <span *ngIf="form.controls.month.errors?.required"
                                                    class="form-text danger mandatory">
                                                    {{'Month' | translate}} {{'IsRequired' | translate}}</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="mandatory ">{{'Year' | translate}}</label>
                                            <mat-select placeholder="Select Year" formControlName="year"
                                                class="form-control pt-2"
                                                [disableOptionCentering]="true">
                                                <!-- <mat-select-filter [array]="years"
                                                    (filteredReturn)="years =$event">
                                                </mat-select-filter> -->
                                                <mat-option *ngFor="let item of years" [value]="item">
                                                    {{item}}
                                                </mat-option>
                                                <!-- <mat-option *ngFor="let year of years" [value]="year">{{ year }}</mat-option> -->
                                            </mat-select>
                                            <div class="valid-error"
                                                *ngIf="form.controls.year.errors && (form.controls.year.dirty || form.controls.year.touched)"
                                                text-wrap>
                                                <span *ngIf="form.controls.year.errors?.required"
                                                    class="form-text danger mandatory">
                                                    {{'Year' | translate}} {{'IsRequired' | translate}}</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label>{{"Employee Name"|translate}}</label>
                                            <mat-select placeholder=" Select Employee Name"
                                                formControlName="employeeName" class="form-control pt-2"
                                                [disableOptionCentering]="true" #select3>
                                                <mat-select-filter [displayMember]="'value'"
                                                    [array]="EmployeeList"
                                                    (filteredReturn)="filtermappedEmployeeList =$event"
                                                    *ngIf="select3.focused">
                                                </mat-select-filter>
                                                <mat-option *ngFor="let item of filtermappedEmployeeList"
                                                    [value]="item.key">
                                                    {{item.value}}
                                                </mat-option>
                                            </mat-select>
                                            <!-- <div class="valid-error"
                                                *ngIf="form.controls.employeeName.errors && (form.controls.employeeName.dirty || form.controls.employeeName.touched)"
                                                text-wrap>
                                                <span *ngIf="form.controls.employeeName.errors?.required"
                                                    class="form-text danger mandatory">
                                                    {{'Project Type' | translate}} {{'IsRequired' | translate}}</span>
                                            </div> -->
                                        </div>
                                    </div>


                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <div class="form-actions mb-2 mt-3" style="float: right;">
                                                <button type="reset" class="btn btn-raised btn-warning mr-1 btncancel"
                                                    (click)="onCancel()">
                                                    <!-- <i class="fa fa-close"></i> -->
                                                    <i class="btn-icon-prepend fa fa-refresh"></i>
                                                    {{'Clear' | translate}}
                                                </button>&nbsp;&nbsp;
                                                <button class="btn btnsave" type="submit"
                                                    (click)="getWorkingHoursDetails()">
                                                    <i class="fa fa-save"></i>
                                                    {{'Get Details' | translate}}
                                                </button>
                                                <!-- <button type="submit" class="btn btnexportexcel"
                                                    (click)="onExportExcel()">
                                                    <i class="btn-icon-prepend fa fa-file-excel-o"></i>
                                                    {{'Download' | translate}}
                                                </button>&nbsp; -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="col-mt-12" style="display: flex; justify-content: end;" *ngIf="show">
    <div class="pl-1 pr-1 mb-1">
        <div class="row d-flex justify-content-between align-items-center flex-wrap grid-margin">
            <div>
                <button type="button" matRipple class="btn btnexportexcel mb-2" style="margin-top: 15px;"
                    (click)="onExportExcel()">
                    <i class="btn-icon-prepend fa fa-file-excel-o"></i>
                    {{'ExportExcel' | translate}}
                </button>&nbsp;&nbsp;
            </div>
        </div>
    </div>
</div>

<mat-form-field class="mb-0 col-sm-12 col-md-12 col-lg-12 col-xl-12" *ngIf="show">
    <input id="search1" matInput (keyup)="applyFilter($event)" placeholder="{{'Search'}}" #searchInput>
</mat-form-field>

<div class="table-responsive" [hidden]="!show" >
    <mat-table #table [dataSource]="dataSource" matSort matSortDirection="asc">
        <ng-container matColumnDef="code">
            <mat-header-cell *matHeaderCellDef mat-sort-header="empCode">{{'Emp Code ' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let dataField">
                <p class="text-truncate txtalign lbl-pointer">{{dataField.empCode}}</p>
            </mat-cell>
        </ng-container>

        <ng-container matColumnDef="Employee">
            <mat-header-cell *matHeaderCellDef mat-sort-header="firstName">{{'Employee' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let dataField">
                <p class="text-truncate txtalign lbl-pointer">{{dataField.firstName}}</p>
            </mat-cell>
        </ng-container>
        <ng-container matColumnDef="Expectedhours">
            <mat-header-cell *matHeaderCellDef mat-sort-header="expectedHours">{{'Expected Working Hours' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let dataField">
                <p class="text-truncate txtalign lbl-pointer">{{dataField.expectedHours}}</p>
            </mat-cell>
        </ng-container>
        <ng-container matColumnDef="workingHours">
            <mat-header-cell *matHeaderCellDef mat-sort-header="totalWorkingHours">{{'Actual Working Hours' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let dataField">
                <p class="text-truncate txtalign lbl-pointer">{{dataField.totalWorkingHours}}</p>
            </mat-cell>
        </ng-container>
        <ng-container *ngFor="let date of dates" [matColumnDef]="date">
            <mat-header-cell *matHeaderCellDef>{{ date }}</mat-header-cell>
            <mat-cell *matCellDef="let row">{{ row.datesAndLoggedHours[date] }}</mat-cell>
        </ng-container>
    
        <ng-container matColumnDef="workingDays">
            <mat-header-cell *matHeaderCellDef mat-sort-header="totalWorkingDays">{{'No.of Working Days' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let dataField">
                <p class="text-truncate txtalign lbl-pointer">{{dataField.totalWorkingDays}}</p>
            </mat-cell>
        </ng-container>
        <ng-container matColumnDef="dateOfJoining">
            <mat-header-cell *matHeaderCellDef mat-sort-header="dateOfJoining">{{'Date of Joining' | translate}}
            </mat-header-cell>
            <mat-cell *matCellDef="let dataField">
                <p class="text-truncate txtalign lbl-pointer">{{dataField.dateOfJoining}}</p>
            </mat-cell>
        </ng-container>
        
        <mat-header-row *matHeaderRowDef="displayedColumns; sticky:true"></mat-header-row>

        <mat-row *matRowDef="let row; columns: displayedColumns;" matRipple>
        </mat-row>
    </mat-table>
</div>


<mat-paginator #paginator [length]="dataSource!=null && dataSource.filteredData.length" [pageIndex]="0" [pageSize]="10"
    [pageSizeOptions]="[10, 25, 50, 100]"  [hidden]="!show">
</mat-paginator><br>